# Blueprint 작성 가이드라인

제품(Product)의 **"왜"와 "어떻게 동작하는가"**를 대상 독자에게 자기완결적으로 전달하는 문서의 포맷 정의다.

> **참고 문서:**
> - PRD 포맷 가이드: `_bmad/docs/prd-format-guide.md`
> - Sprint Kit Blueprint (인스턴스): `docs/blueprint.md`
> - JDD 철학: `docs/judgment-driven-development.md`

---

## 1. 자기완결 원칙

Blueprint의 대상 독자가 **코드를 읽지 않는다면**, 운영 상세도 Blueprint에 포함해야 한다.

- "상세는 코드 참조", "에이전트 파일 참조"는 대상 독자가 코드를 읽을 수 있을 때만 허용
- Blueprint는 대상 독자를 위한 **유일한 종합 문서**
- 도구, 에이전트, 워크플로우의 동작 설명이 에이전트 정의 파일과 "중복"이더라도, 대상 독자가 접근 가능한 **유일한 형태**이므로 반드시 포함

**검증 기준**: 대상 독자가 이 문서 하나만으로 AI와 함께 이 제품/서비스를 다시 만들어낼 수 있는가.

---

## 2. YAML Frontmatter

모든 Blueprint는 YAML frontmatter로 시작한다.

```yaml
---
synced_to: "{commit-hash}"     # Blueprint 외 소스 파일 변경 중 마지막 반영 커밋
audience: "{대상 독자}"          # 예: "비개발자 제품 전문가", "팀 전체", "외부 투자자"
product: "{제품명}"
version: "{문서 버전}"
---
```

### 필수 필드

| 필드 | 용도 |
|------|------|
| `audience` | 대상 독자 정의. 자기완결 수준과 용어 깊이를 결정 |
| `product` | Blueprint가 다루는 제품/서비스명 |

### 선택 필드

| 필드 | 용도 |
|------|------|
| `synced_to` | 소스 파일 동기화 추적 (Blueprint 외 파일의 마지막 반영 커밋) |
| `version` | 문서 버전 |

---

## 3. 비전 선언

Frontmatter 바로 아래에 인용 블록으로 **비전 선언**을 배치한다.

- 제품이 지향하는 바를 3~5문장으로 서술
- 대상 독자가 첫 문단에서 "이 제품이 뭔지"를 파악할 수 있어야 함
- **유일한 원칙**: 비전 선언 마지막에 제품의 핵심 원칙을 한 문장으로 명시

```markdown
> {제품}은 {누구}가 {무엇}을 할 수 있는 {도구/서비스/플랫폼}을 지향한다.
> ...
>
> 유일한 원칙: **{한 문장 핵심 원칙}**
```

---

## 4. 8-Section 구조

### 개요

| # | 섹션 | 한 줄 목적 |
|---|------|-----------|
| 1 | **Problem** | 이 제품이 존재하는 이유 |
| 2 | **Thesis** | 핵심 원칙 + 설계 판단 + 전제 조건 |
| 3 | **User Model** | 누가 사용하고, 무슨 역할을 하는가 |
| 4 | **Value Chain** | 시스템 구성 + 파이프라인 + 경로 + 비용 |
| 5 | **Judgment & Feedback** | 판단 방식 + 피드백 반영 메커니즘 |
| 6 | **Constraints & Trade-offs** | 하지 않는 것 + 의식적 트레이드오프 |
| 7 | **Risk Model** | 가정 + 깨지면 + 감지 신호 |
| 8 | **Current State** | 현재 상태 + 미검증 가설 + 알려진 갭 |

### Appendix (선택)

| Appendix | 용도 |
|----------|------|
| A. 설치와 운영 | 셋업, 설정, 운영 가이드 |
| B. 파일 구조 | 디렉토리 트리 + 파일별 역할 |
| C. 용어집 | 제품 고유 용어 정의 |

---

## 5. 섹션별 작성 규칙

### §1 Problem

**목적**: 이 제품이 풀려는 문제를 정의한다.

**필수 요소**:
- 문제의 현재 상태 (누가, 어떤 상황에서 어려움을 겪는가)
- 기존 해결책이 왜 불충분한가
- 이 문제가 중요한 이유

**품질 기준**:
- 비전문가가 읽어도 문제의 심각성을 이해할 수 있어야 한다
- 솔루션 언급 없이 문제만 서술한다

**안티패턴**:
- ❌ 솔루션을 먼저 설명하고 문제를 역추론
- ❌ 업계 전문 용어로만 서술하여 대상 독자가 이해 불가

---

### §2 Thesis

**목적**: 문제에 대한 핵심 원칙과 설계 판단을 명시한다.

**필수 구조**:

```
2. Thesis
  2.1 핵심 원칙 — 한 문장. 비전 선언의 "유일한 원칙"과 동일
  2.2 설계 판단 — 핵심 원칙을 실현하기 위한 구체적 판단들
  2.3 전제 조건 — 핵심 원칙이 성립하려면 참이어야 하는 것
  2.4 원칙이 틀렸을 때 — 핵심 원칙이 실패하는 시나리오
```

**§2.1 핵심 원칙**:
- 한 문장으로 서술
- 비전 선언에서 이미 선언한 원칙의 재진술

**§2.2 설계 판단**:
- 수와 형식은 자유 (3~10개 권장)
- 각 판단은 다음 구조를 따른다:
  - **이름** (영문, 짧은 선언문)
  - **한 줄 요약** (인용 블록)
  - **설명**: 왜 이 판단인가 + 예시
  - **제품 구현**: 이 판단이 제품에서 어떻게 나타나는가

**§2.3 전제 조건**:
- 핵심 원칙이 성립하려면 참이어야 하는 것들
- 예: "AI 생성 품질이 검토할 만한 수준이어야 한다"

**§2.4 원칙이 틀렸을 때**:
- 핵심 원칙이 실패하는 시나리오
- 실패 시 어떤 일이 벌어지는가

**품질 기준**:
- §2.2의 각 설계 판단이 §4(Value Chain), §5(Judgment), §6(Constraints)에서 근거로 참조되어야 한다
- "원칙 → 판단 → 구현"의 인과 관계가 명확해야 한다

**안티패턴**:
- ❌ 설계 판단에 번호를 부여하여 "원칙 1, 원칙 2"처럼 서술 (판단은 원칙이 아님)
- ❌ 판단의 근거 없이 선언만 나열
- ❌ 전제 조건과 실패 시나리오 누락

---

### §3 User Model

**목적**: 누가 이 제품을 사용하고, 어떤 역할을 하는가.

**필수 요소**:
- 대상 사용자 정의 (긍정형: 무엇을 아는 사람)
- 사용자가 하는 일 (구체적 역할/행동 목록)
- 시스템이 하는 일 (사용자가 하지 않는 것)

**품질 기준**:
- 사용자를 소거법(~가 아닌 사람)이 아니라 전문성 중심으로 정의
- 사용자 역할과 시스템 역할의 경계가 명확

**안티패턴**:
- ❌ "비개발자", "비전문가" 등 소거법적 정의
- ❌ 사용자와 시스템의 역할 경계가 모호

---

### §4 Value Chain

**목적**: 제품이 어떻게 가치를 전달하는가. 시스템 구성, 작동 과정, 경로, 비용을 설명한다.

**필수 구조**:

```
4. Value Chain
  4.1 시스템 구성 요소 — 도구, 에이전트, 외부 연동 등
  4.2 파이프라인 — 전체 워크플로우 상세
  4.3 경로 선택 — 입력 상태/사용자 유형에 따른 변형
  4.4 비용 구조 — 비용 공식 또는 ROI 분석
```

**§4.1 시스템 구성 요소**:
- 도구/서비스/에이전트/외부 연동 테이블
- 각 구성 요소의 역할 한 줄 설명

**§4.2 파이프라인**:
- **Follow-Along 패턴 권장**: 각 단계에서 "사용자가 보는 것(외부)"과 "시스템 동작(내부)"을 병행 서술
- 각 단계에 다음 요소 포함:
  - 사용자 시점: 사용자가 하는 일 / 받는 것
  - 시스템 내부: 입력 → 처리 → 출력
  - 산출물: 생성되는 결과물
  - 실패 시: 에러 상황과 대응
  - **근거 설계 판단**: 이 단계가 존재하는 이유 (§2.2 참조)
- 대상 독자에 맞는 깊이로 서술
  - 배달 앱: "주문 → 매칭 → 배달 → 평가" 수준의 요약
  - 개발 도구: Phase별 상세 워크스루

**§4.3 경로 선택**:
- 입력 상태/사용자 유형에 따른 분기
- 모든 경로의 합류점 명시
- 경로 간 전환(크로스오버) 가능 여부

**§4.4 비용 구조**:
- 비용 공식 또는 ROI 비교
- 현실 워크플로우와의 시간/비용 비교 (해당 시)

**품질 기준**:
- §4.2의 각 단계에 근거 설계 판단이 명시되어야 한다
- 대상 독자가 전체 프로세스를 처음부터 끝까지 따라갈 수 있어야 한다

**안티패턴**:
- ❌ 구성 요소만 나열하고 동작 흐름 누락
- ❌ 파이프라인에서 실패 경로 누락
- ❌ "상세는 코드 참조" (자기완결 원칙 위반)

---

### §5 Judgment & Feedback

**목적**: 사용자가 어떻게 판단하고, 피드백이 어떻게 반영되는가.

**필수 요소**:
- 판단 모델 (JP, 별점, 퀴즈, 리뷰 등 제품에 맞는 형태)
- 각 판단 시점의 상세 (무엇을 보고, 무엇을 판단하고, 어떻게 응답하는가)
- 피드백 반영 메커니즘 (피드백이 시스템에 어떻게 반영되는가)
- 역방향 루프 (후속 단계에서 이전 단계 오류를 발견하는 경우)

**품질 기준**:
- 판단 시점이 §2.2 설계 판단의 구현임을 명시
- 피드백 반영 경로가 구체적 (어떤 범위가 수정/재생성되는가)

**안티패턴**:
- ❌ "사용자 피드백을 반영합니다" 수준의 추상적 서술
- ❌ 피드백 반영 비용/범위 누락

---

### §6 Constraints & Trade-offs

**목적**: 이 제품이 의식적으로 하지 않는 것과 트레이드오프를 명시한다.

**필수 요소**:
- 경계 (Boundaries): 이 제품이 하지 않는 것
- 트레이드오프: 의식적으로 선택한 방향과 그 대가
- 열어둔 것: 아직 결정하지 않은 것과 이유

**품질 기준**:
- 각 트레이드오프가 §2.2 설계 판단과 연결
- "하지 않는 것"이 명확하여 범위 혼동이 없어야 한다

**안티패턴**:
- ❌ 제약 없이 "모든 것을 할 수 있다"
- ❌ 트레이드오프의 대가(cost)를 숨김

---

### §7 Risk Model

**목적**: 제품의 핵심 가정, 가정이 깨지면 벌어지는 일, 감지 신호를 정의한다.

**필수 구조**:

| 가정 | 깨지면 | 감지 신호 |
|------|--------|----------|
| {무엇이 참이어야 하는가} | {깨졌을 때 영향} | {어떻게 알 수 있는가} |

**품질 기준**:
- §2.3 전제 조건과 연결
- 감지 신호가 구체적이고 측정 가능

**안티패턴**:
- ❌ 리스크를 나열만 하고 감지 방법 누락
- ❌ "리스크 없음"

---

### §8 Current State

**목적**: 제품의 현재 상태를 솔직하게 기술한다.

**필수 요소**:
- 현재 버전/상태
- 미검증 가설 (아직 실사용으로 검증되지 않은 것)
- 알려진 갭 (설계와 구현 사이의 차이)

**품질 기준**:
- CHANGELOG 또는 릴리스 노트와 정합
- 미검증 가설이 §7의 가정과 연결

**안티패턴**:
- ❌ 미완성 상태를 숨기고 "완성된 제품"으로 서술
- ❌ 구현되지 않은 기능을 마치 구현된 것처럼 서술

---

## 6. Appendix 가이드

Appendix는 본문의 흐름을 방해하지 않으면서 레퍼런스가 필요한 정보를 담는다.

**원칙**:
- Appendix도 자기완결 원칙을 따른다. 에이전트 파일이나 코드를 참조하지 않는다
- 대상 독자가 Appendix 내에서 모든 용어와 구조를 이해할 수 있어야 한다

**일반적인 Appendix**:

| Appendix | 용도 | 포함 기준 |
|----------|------|----------|
| 설치와 운영 | 셋업, 설정, 운영 가이드 | 대상 독자가 직접 설치/운영하는 경우 |
| 파일 구조 | 디렉토리 트리 + 파일별 역할 | 파일 구조 이해가 필요한 경우 |
| 용어집 | 제품 고유 용어 정의 | 제품 고유 용어가 10개 이상인 경우 |

---

## 7. 작성 규칙

### 언어

- 대상 독자의 언어에 맞춘다 (한국어 제품은 한국어, 국제 제품은 영어)
- 기술 용어는 대상 독자 수준에 맞게 사용. 불가피한 경우 용어집(Appendix C)에서 정의

### 정보 밀도

- 모든 문장이 정보 무게를 가져야 한다
- 채움말, 반복, 장식적 서술 제거
- 테이블이 산문보다 효율적이면 테이블 사용

### 참조 규칙

- Blueprint 내부 섹션 간 참조: `§{번호}` 형식 (예: "§2.2 설계 판단 참조")
- 외부 문서 참조: 자기완결 원칙을 먼저 확인. 대상 독자가 접근 가능한 경우만 참조
- 설계 판단 참조: §4, §5, §6에서 근거를 밝힐 때 판단의 영문명 사용

### 길이 가이드

| 제품 복잡도 | 예상 분량 | §4 비중 |
|------------|----------|---------|
| 단순 (단일 기능) | 200~400줄 | 30% |
| 중간 (다기능 서비스) | 400~800줄 | 40% |
| 복합 (플랫폼/도구킷) | 800~1200줄 | 45% |

---

## 8. 체크리스트 (Self-Review)

Blueprint 작성 완료 후 다음을 확인한다:

### 구조

- [ ] YAML frontmatter에 `audience` 필드 존재
- [ ] 비전 선언이 frontmatter 바로 아래에 존재
- [ ] 8개 섹션이 모두 존재 (§1~§8)
- [ ] Appendix가 필요한 경우 포함

### 자기완결

- [ ] "코드 참조", "에이전트 파일 참조" 문구가 0건
- [ ] 대상 독자가 이 문서만으로 제품을 이해할 수 있는가
- [ ] 모든 용어가 문서 내에서 정의되거나 용어집에 있는가

### 인과 관계

- [ ] §2.1(원칙) → §2.2(판단) → §4/§5/§6에서 근거로 참조
- [ ] §2.3(전제 조건) → §7(Risk Model)에서 연결
- [ ] §4.2의 각 단계에 근거 설계 판단이 명시

### 정보 보존 (기존 문서 재작성 시)

- [ ] 기존 문서의 모든 정보가 새 구조에 매핑됨
- [ ] 손실 항목이 없음을 매핑 테이블로 검증

### 정합성

- [ ] 비전 선언의 핵심 원칙 = §2.1 핵심 원칙 (동일 문장)
- [ ] §8 Current State가 CHANGELOG와 정합
- [ ] 외부 참조 문서(JDD 등)와 중복이 아닌 역할 분담
